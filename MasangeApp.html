<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Message Virtual</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #8a2be2;
            --primary-dark: #6a1cb0;
            --primary-light: #9d4edd;
            --secondary: #da70d6;
            --background: #0f0f0f;
            --surface: #1a1a1a;
            --surface-light: #2d2d2d;
            --text: #ffffff;
            --text-secondary: #b0b0b0;
            --success: #00ff88;
            --warning: #ffaa00;
            --error: #ff4444;
            --gold: #ffd700;
            --neon-purple: #c724ff;
            --neon-pink: #ff2a6d;
            --verified: #0099ff;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0033 50%, #0a0a0a 100%);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            padding: 0;
            position: relative;
            overflow-x: hidden;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 0;
            position: relative;
            z-index: 1;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* –•–µ–¥–µ—Ä */
        .header {
            text-align: center;
            padding: 20px;
            background: rgba(15, 15, 15, 0.95);
            border-bottom: 1px solid rgba(138, 43, 226, 0.3);
        }

        .logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            box-shadow: 0 0 20px var(--primary);
        }

        .rocket {
            animation: rocketFly 3s ease-in-out infinite;
        }

        @keyframes rocketFly {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-8px) rotate(-5deg); }
            50% { transform: translateY(-12px) rotate(0deg); }
            75% { transform: translateY(-8px) rotate(5deg); }
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
            background: linear-gradient(45deg, var(--neon-purple), var(--neon-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }

        .header-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.4;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            padding-bottom: 80px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.8), rgba(45, 0, 54, 0.6));
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(138, 43, 226, 0.3);
            backdrop-filter: blur(10px);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 15px;
            padding: 16px 20px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-gold {
            background: linear-gradient(135deg, var(--gold), #ffaa00);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-icon {
            margin-right: 10px;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 15, 15, 0.95);
            padding: 12px 20px;
            display: flex;
            justify-content: space-around;
            border-top: 1px solid rgba(138, 43, 226, 0.3);
            z-index: 1000;
        }

        .nav-item {
            text-align: center;
            padding: 8px 12px;
            cursor: pointer;
            flex: 1;
            transition: all 0.3s ease;
            border-radius: 10px;
        }

        .nav-item.active {
            background: rgba(138, 43, 226, 0.2);
        }

        .nav-item.active .nav-icon {
            color: var(--secondary);
        }

        .nav-item.active .nav-text {
            color: var(--secondary);
            font-weight: 700;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
            color: var(--text-secondary);
        }

        .nav-text {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* –≠–∫—Ä–∞–Ω—ã */
        .screen {
            display: none;
        }

        /* –ß–∞—Ç */
        .chat-messages {
            height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: rgba(26, 26, 26, 0.5);
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        .no-messages {
            text-align: center;
            color: var(--text-secondary);
            padding: 40px 20px;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .user-message {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            margin-left: auto;
        }

        .admin-message {
            background: var(--surface-light);
            margin-right: auto;
            border: 1px solid rgba(138, 43, 226, 0.1);
        }

        .message-sender {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 5px;
            opacity: 0.8;
        }

        .message-time {
            font-size: 10px;
            opacity: 0.7;
            margin-top: 5px;
            text-align: right;
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: none;
            background: var(--surface);
            color: var(--text);
            border-radius: 20px;
            font-size: 16px;
            border: 1px solid rgba(138, 43, 226, 0.3);
        }

        .send-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            color: white;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-stats {
            background: var(--surface);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .stat-value {
            font-weight: 600;
            font-size: 16px;
        }

        .verified-text {
            color: var(--verified);
        }

        /* –û—Ç–≤–µ—Ç—ã */
        .replies-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .reply-item {
            background: var(--surface);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid rgba(138, 43, 226, 0.2);
        }

        .reply-question {
            color: var(--text);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .reply-answer {
            color: var(--success);
            background: rgba(0, 255, 136, 0.1);
            padding: 10px;
            border-radius: 8px;
            border-left: 3px solid var(--success);
        }

        .no-replies {
            text-align: center;
            color: var(--text-secondary);
            padding: 40px 20px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
        <div class="main-screen screen" id="mainScreen">
            <div class="header">
                <div class="logo">
                    <div class="rocket">
                        <i class="fas fa-rocket"></i>
                    </div>
                </div>
                <h1>Message Virtual</h1>
                <div class="header-subtitle">—Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –º–µ–Ω—è —ç—Ç–æ –ª—É—á—à–∏–π –ø–æ–¥–∞—Ä–æ–∫ –æ—Ç —Ç–µ–±—è‚ù§</div>
            </div>
            
            <div class="content">
                <div class="card">
                    <div style="text-align: center; font-size: 18px; font-weight: 600;">
                        –ù–∞–ø–∏—à–∏ —É–∂–µ —Å–µ–π—á–∞—Å <span style="color: var(--neon-purple);">—Å–æ–æ–±—â–µ–Ω–∏–µ</span> –º–Ω–µ! üí´
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="showScreen('chatScreen')">
                        <i class="fas fa-edit btn-icon"></i>
                        üöÄ –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
                    </button>
                    
                    <button class="btn btn-secondary" onclick="showScreen('profileScreen')">
                        <i class="fas fa-user btn-icon"></i>
                        –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω —á–∞—Ç–∞ -->
        <div class="chat-screen screen" id="chatScreen">
            <div class="header">
                <div class="logo" style="width: 60px; height: 60px;">
                    <i class="fas fa-comments"></i>
                </div>
                <h1>–ß–∞—Ç —Å Virtual</h1>
                <div class="header-subtitle">–ü–∏—à–∏ —Å–≤–æ–∏ –º—ã—Å–ª–∏, —è –æ—Ç–≤–µ—á—É! üíú</div>
            </div>
            
            <div class="content">
                <div class="chat-messages" id="chatMessages">
                    <div class="no-messages" id="noMessages">
                        üí¨ –£ –≤–∞—Å –µ—â—ë –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π —Å Virtual<br>
                        <small>–ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∂–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç–∞!</small>
                    </div>
                </div>
                
                <div class="chat-input-container">
                    <input type="text" class="chat-input" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                    <button class="send-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è -->
        <div class="screen" id="profileScreen">
            <div class="header">
                <div class="logo" style="width: 60px; height: 60px;">
                    <i class="fas fa-user"></i>
                </div>
                <h1>–ú–æ–π –ü—Ä–æ—Ñ–∏–ª—å</h1>
                <div class="header-subtitle">–¢–≤–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
            </div>
            
            <div class="content">
                <div class="card">
                    <div style="text-align: center; margin-bottom: 15px;">
                        <div style="font-size: 20px; font-weight: 700;" id="profileName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        <div style="color: var(--text-secondary);" id="profileUsername">@username</div>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-row">
                        <span class="stat-label">üë§ –ò–º—è:</span>
                        <span class="stat-value" id="statName">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">üîó –Æ–∑–µ—Ä:</span>
                        <span class="stat-value" id="statUsername">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">üéñÔ∏è –†–∞–Ω–≥:</span>
                        <span class="stat-value" id="statRank">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">üì® –°–æ–æ–±—â–µ–Ω–∏–π:</span>
                        <span class="stat-value" id="statMessages">0</span>
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn" onclick="loadReplies()">
                        <i class="fas fa-envelope btn-icon"></i>
                        üì© –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–≤–µ—Ç—ã
                    </button>
                    
                    <button class="btn btn-gold" id="adminPanelBtn" style="display: none;" onclick="tg.showAlert('üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–æ—Ç–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É /profile')">
                        <i class="fas fa-crown btn-icon"></i>
                        üëë –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª—å
                    </button>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ—Ç–≤–µ—Ç–æ–≤ -->
        <div class="screen" id="repliesScreen">
            <div class="header">
                <div class="logo" style="width: 60px; height: 60px;">
                    <i class="fas fa-envelope"></i>
                </div>
                <h1>–ú–æ–∏ –û—Ç–≤–µ—Ç—ã</h1>
                <div class="header-subtitle">–û—Ç–≤–µ—Ç—ã –æ—Ç Virtual</div>
            </div>
            
            <div class="content">
                <div class="replies-list" id="repliesList">
                    <div class="loading" id="repliesLoading">
                        <i class="fas fa-spinner fa-spin"></i><br>
                        –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç–≤–µ—Ç—ã...
                    </div>
                </div>
                
                <div class="btn-container">
                    <button class="btn btn-secondary" onclick="showScreen('profileScreen')">
                        <i class="fas fa-arrow-left btn-icon"></i>
                        –ù–∞–∑–∞–¥
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="showScreen('mainScreen')">
            <div class="nav-icon"><i class="fas fa-home"></i></div>
            <div class="nav-text">–ì–ª–∞–≤–Ω–∞—è</div>
        </div>
        <div class="nav-item" onclick="showScreen('chatScreen')">
            <div class="nav-icon"><i class="fas fa-comments"></i></div>
            <div class="nav-text">–ß–∞—Ç</div>
        </div>
        <div class="nav-item" onclick="showScreen('profileScreen')">
            <div class="nav-icon"><i class="fas fa-user"></i></div>
            <div class="nav-text">–ü—Ä–æ—Ñ–∏–ª—å</div>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        let user = tg.initDataUnsafe.user;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp
        tg.expand();
        tg.enableClosingConfirmation();
        tg.BackButton.hide();

        const ADMIN_IDS = [6831285989];
        
        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userData = {
            messageCount: parseInt(localStorage.getItem('messageCount')) || 0,
            chatMessages: JSON.parse(localStorage.getItem('chatMessages')) || [],
            replies: JSON.parse(localStorage.getItem('replies')) || []
        };

        function isAdmin(userId) {
            return ADMIN_IDS.includes(Number(userId));
        }

        function saveUserData() {
            localStorage.setItem('messageCount', userData.messageCount);
            localStorage.setItem('chatMessages', JSON.stringify(userData.chatMessages));
            localStorage.setItem('replies', JSON.stringify(userData.replies));
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.style.display = 'none';
            });
            document.getElementById(screenId).style.display = 'block';
            updateNav(screenId);
            
            if (screenId === 'profileScreen') {
                loadProfileData();
            } else if (screenId === 'chatScreen') {
                loadChatData();
                setTimeout(() => {
                    const input = document.getElementById('messageInput');
                    input.focus();
                    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º zoom –Ω–∞ iOS
                    input.style.fontSize = '16px';
                }, 100);
            }
        }

        function updateNav(screenId) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const navs = document.querySelectorAll('.nav-item');
            if (screenId === 'mainScreen') navs[0].classList.add('active');
            else if (screenId === 'chatScreen') navs[1].classList.add('active');
            else if (screenId === 'profileScreen') navs[2].classList.add('active');
        }

        function loadProfileData() {
            if (user) {
                document.getElementById('profileName').textContent = user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('profileUsername').textContent = user.username ? '@' + user.username : '–ù–µ —É–∫–∞–∑–∞–Ω';
                document.getElementById('statName').textContent = user.first_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                document.getElementById('statUsername').textContent = user.username ? '@' + user.username : '–ù–µ —É–∫–∞–∑–∞–Ω';
            }
            
            document.getElementById('statMessages').textContent = userData.messageCount;
            
            if (user && isAdmin(user.id)) {
                document.getElementById('statRank').textContent = 'Virtual üëë';
                document.getElementById('statRank').className = 'stat-value verified-text';
                document.getElementById('adminPanelBtn').style.display = 'block';
            }
        }

        function loadChatData() {
            const chat = document.getElementById('chatMessages');
            const noMsg = document.getElementById('noMessages');
            
            if (userData.chatMessages.length === 0) {
                noMsg.style.display = 'block';
                chat.innerHTML = '<div class="no-messages">üí¨ –£ –≤–∞—Å –µ—â—ë –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π —Å Virtual<br><small>–ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∂–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç–∞!</small></div>';
            } else {
                noMsg.style.display = 'none';
                let html = '';
                userData.chatMessages.forEach(msg => {
                    const senderName = msg.sender === 'admin' ? 'Virtual' : (user?.first_name || '–í—ã');
                    html += `<div class="message ${msg.sender}-message">
                        <div class="message-sender">${senderName}</div>
                        ${msg.text}
                        <div class="message-time">${msg.time}</div>
                    </div>`;
                });
                chat.innerHTML = html;
                chat.scrollTop = chat.scrollHeight;
            }
        }

        function loadReplies() {
            showScreen('repliesScreen');
            const list = document.getElementById('repliesList');
            
            list.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i><br>–ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç–≤–µ—Ç—ã...</div>';
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
            setTimeout(() => {
                if (userData.replies.length === 0) {
                    list.innerHTML = '<div class="no-replies">üì≠ –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤<br><small>–ö–æ–≥–¥–∞ Virtual –æ—Ç–≤–µ—Ç–∏—Ç, –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</small></div>';
                } else {
                    let html = '';
                    userData.replies.forEach((reply, index) => {
                        html += `<div class="reply-item">
                            <div class="reply-question">${reply.question || `–í–æ–ø—Ä–æ—Å ${index + 1}`}</div>
                            <div class="reply-answer">${reply.answer}</div>
                        </div>`;
                    });
                    list.innerHTML = html;
                }
            }, 1000);
        }

        // üîß –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–Ø
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π"
            document.getElementById('noMessages').style.display = 'none';
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Ç
            const time = new Date().toLocaleTimeString('ru-RU', { 
                hour: '2-digit', minute: '2-digit' 
            });
            
            userData.chatMessages.push({
                text: message,
                sender: 'user',
                time: time
            });
            
            userData.messageCount++;
            saveUserData();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
            document.getElementById('statMessages').textContent = userData.messageCount;
            
            // üîß –û–¢–ü–†–ê–í–ö–ê –°–û–û–ë–©–ï–ù–ò–Ø –ë–û–¢–£ –ß–ï–†–ï–ó TELEGRAM BOT API
            sendMessageToBot(message);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —á–∞—Ç
            loadChatData();
            input.value = '';
            
            // –ê–≤—Ç–æ-–æ—Ç–≤–µ—Ç –æ—Ç Virtual (–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –ø–æ–∫–∞ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç)
            setTimeout(() => {
                const replies = [
                    "–ü—Ä–∏–≤–µ—Ç! –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ! –Ø —Å–≤—è–∂—É—Å—å —Å —Ç–æ–±–æ–π –æ—á–µ–Ω—å —Å–∫–æ—Ä–æ üöÄ",
                    "–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ! –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é... ü§î",
                    "–ü–æ–ª—É—á–∏–ª —Ç–≤–æ–π —Å–∏–≥–Ω–∞–ª! –°–∫–æ—Ä–æ –±—É–¥–µ—Ç –æ—Ç–≤–µ—Ç! üí´",
                    "–°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ! –ù–∞—á–∏–Ω–∞—é –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–≤–µ—Ç–∞... ‚ö°"
                ];
                const randomReply = replies[Math.floor(Math.random() * replies.length)];
                
                const replyTime = new Date().toLocaleTimeString('ru-RU', { 
                    hour: '2-digit', minute: '2-digit' 
                });
                
                userData.chatMessages.push({
                    text: randomReply,
                    sender: 'admin',
                    time: replyTime
                });
                
                saveUserData();
                loadChatData();
            }, 1500);
        }

        // üîß –§–£–ù–ö–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–Ø –ë–û–¢–£
        function sendMessageToBot(message) {
            // –°–æ–∑–¥–∞–µ–º URL –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç—É
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–æ–≤ API —Ç–≤–æ–µ–≥–æ –±–æ—Ç–∞
            const botToken = "8533787001:AAEwJT9gHZ02fJSiOCaaOwTVnJeTytJRogs";
            const chatId = ADMIN_IDS[0]; // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∞–¥–º–∏–Ω—É
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞
            const adminMessage = `üì® –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!\n\nüë§ –ò–º—è: ${user?.first_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\nüîó –Æ–∑–µ—Ä–Ω–µ–π–º: @${user?.username || '–Ω–µ—Ç'}\nüÜî ID: ${user?.id || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n\nüí¨ –°–æ–æ–±—â–µ–Ω–∏–µ:\n${message}`;
            
            // –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ Telegram Bot API
            fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: adminMessage,
                    parse_mode: 'HTML'
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É:', data);
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç—É:', error);
                // –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —á–µ—Ä–µ–∑ API, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
                tg.showAlert(`üì® –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ! –ß—Ç–æ–±—ã –∞–¥–º–∏–Ω –ø–æ–ª—É—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ–π–¥–∏ –≤ –±–æ—Ç–∞ @VirtualMessageBot –∏ –æ—Ç–ø—Ä–∞–≤—å –∫–æ–º–∞–Ω–¥—É /start`);
            });
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ WebApp Data (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –±–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö)
            try {
                tg.sendData(JSON.stringify({
                    action: 'new_message',
                    text: message,
                    user_id: user?.id,
                    user_name: user?.first_name,
                    username: user?.username,
                    timestamp: Date.now()
                }));
            } catch (e) {
                console.log('WebApp Data –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω');
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ "–ß–∞—Ç"
        document.querySelector('.nav-item:nth-child(2)').addEventListener('click', function() {
            setTimeout(() => {
                const input = document.getElementById('messageInput');
                if (input) input.focus();
            }, 100);
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadUserData();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
            showScreen('mainScreen');
            
            // –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            console.log('Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            console.log('User:', user);
            console.log('User Data:', userData);
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞)
        function loadUserData() {
            // –í –±—É–¥—É—â–µ–º –∑–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
            console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
        }
    </script>
</body>
</html>